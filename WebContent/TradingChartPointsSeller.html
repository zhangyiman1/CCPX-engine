<!DOCTYPE html>
<html lang="en">

	<head>
		<title>Trading Charts</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="bootstrap/css/bootstrap.css" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="bootstrap/css/jquery.datetimepicker.css"/>
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
        <script src="js/jquery-1.11.2.js"></script>
        <script src="js/bootstrap.js"></script>
		<script src="js/highcharts.js"></script>
		<script src="js/exporting.js"></script>
		<script src="js/jquery.datetimepicker.js"></script>
		<script src="js/ljs.js"></script>
	</head>
	
	<body>
		<div class="container">
			<div class="header">

				<!-- Form Name -->
				<legend>Trading Charts</legend>
			
				<!-- Navbar --> 
				<nav class="navbar navbar-default" style="background-image: url('img/red.png'); background-position : 10% 10%;" role="navigation">
					<div class="container-fluid">  
						<div class="navbar-header">
							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
									data-target="#mynav">
								<span class="sr-only">change nav</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
                                <span class="icon-bar"></span>
								<span class="icon-bar"></span>
					   
							</button>
							<a class="navbar-brand" href="#">Exchange Platform</a>
						</div>
						<div class="collapse navbar-collapse" id="mynav">
							<ul class="nav navbar-nav center-block pull-right">
<li class="nav-item pull-left">
								  <a class="nav-link" href="HomePage.html"><span class="glyphicon glyphicon-home"></span> Home </a>
								</li>
								
								<li class="nav-item pull-left">
								  <a class="nav-link" href="BusinessPage.html"><span class="glyphicon glyphicon-user"></span> Account </a>
								</li>
								
								 <li class="nav-item pull-left">
								  <a class="nav-link" href="Advertisements.html"><span class="glyphicon glyphicon-bullhorn"></span> Advertisements </a>
								</li>
								
								<li class="nav-item pull-left">
								<a class="nav-link" href="StatisticsCenter.html"><span class="glyphicon glyphicon-stats"></span> Statistics Center </a>
								</li>	
                                
                                <li class="nav-item pull-left">
								<a class="nav-link" href="MainPage.html"><span class="glyphicon glyphicon-log-out"></span> Logout </a>
								</li>		
							</ul>
						</div> 
					</div>
				</nav>
			
				<!-- Website Logo -->
				<div class="row">
					<label class="col-md-5 col-sm-4 col-xs-3 control-label" for="Logo"></label>
					<div class="col-md-2 col-sm-4 col-xs-6">
						<img class="img-responsive center-block" src="img/logo.png" width="60%" />
					</div>
				</div>
				
			<form class="form-horizontal">
			<fieldset>				
				<!-- Time Search input-->
				<div class="form-group">
					<label class="col-md-4 col-sm-4 col-xs-3 control-label" for="CompanysName"> Time Range:
					</label>  
					<div class="col-md-2 col-sm-3 col-xs-8"> From	
						<div class="input-group">
							<input type="text" id="datetimepicker1" class="form-control form_datetime" value=""/>
							<span class="input-group-addon">
								<span class="glyphicon glyphicon-calendar"></span>
							</span>
						</div>
					</div>
					<div class="col-md-2 col-sm-3 col-xs-6"> To
						<div class="input-group" >
							<input type="text" class="form_datetime form-control" id="datetimepicker2" value=""/>
							<span class="input-group-addon">
								<span class="glyphicon glyphicon-calendar"></span>
							</span>
						</div>
					</div>
                    <script type="text/javascript">
							$(".form_datetime").datetimepicker( {  
									format: 'Y/m/d h:m:s',
									autoclose: true
							});
						
				    </script>
                    <button type="button" id="searchBtn" class="btn btn-default btn-info"><i class="glyphicon glyphicon-search"></i></button>              
				</div>
				<div class="form-horizontal">
                    <label class="col-md-4 col-sm-4 col-xs-3 control-label" for="CompanysName"> Trading Type:</label>
                    <div class="col-md-2 col-sm-3 col-xs-6"> Trading Point	
						<input id="tradeType0" name="trade type" checked="checked" type="radio" value="0" />
					</div>
					<div class="col-md-2 col-sm-3 col-xs-6"> Trading Count
						<input id="tradeType1" name="trade type" type="radio" value="1" />
					</div>
				</div>		
			</fieldset>
			</form>
	
          <hr class="col-md-12">        
  		  </div>

				<!-- message-->
				<div class="row">
					<div class="col-md-4 col-sm-3 col-xs-2">
					</div>
					<p class="col-md-4 col-sm-6 col-xs-8" id="message">
					</p>
				</div>
			</div>
			
				<!-- graph-->
					<div class="col-md-6 col-sm-6 col-xs-12">
						<div id="container1" style="min-width: 300px; height: 400px; margin: 0 auto"></div>
					</div>
					<div class="col-md-6 col-sm-6 col-xs-12">
						<div id="container2" style="min-width: 300px; height: 400px; margin: 0 auto"></div>
					</div>
					<div class="col-md-6 col-sm-6 col-xs-12">
						<div id="container3" style="min-width: 300px; height: 400px; margin: 0 auto"></div>
					</div>
					<div class="col-md-6 col-sm-6 col-xs-12">
						<div id="container4" style="min-width: 300px; height: 400px; margin: 0 auto"></div>
					</div>

					<script type="text/javascript">
						$("#searchBtn").click(function(){
							var options1={
									chart:{
										renderTo: 'container1',
									    type: 'column'
										},
									title: {
										text: 'Same industry ranking'
									},
									subtitle: {
										text: ''
									},
									xAxis: {
										type: 'category',
										labels: {
											rotation: -45,
											style: {
												fontSize: '13px',
												fontFamily: 'Verdana, sans-serif'
											}
										}
									},
									yAxis: {
										min: 0,
										title: {
											text: ''
										}
									},
									legend: {
										enabled: false
									},
									tooltip: {
										pointFormat: '<b>{point.y:.1f} POINTS</b>'
									},
									series: [{
										name: 'Companies',
										data: [],
										dataLabels: {
											enabled: true,
											rotation: -90,
											color: '#FFFFFF',
											align: 'right',
											format: '{point.y:.1f}', // one decimal
											y: 10, // 10 pixels down from the top
											style: {
												fontSize: '13px',
												fontFamily: 'Verdana, sans-serif'
											}
										}
									}]
							};//define chart done
							
							var options2={
								chart: {
									renderTo: 'container2',
									type: 'column'
								},
								title: {
									text: 'Different industry ranking'
								},
								subtitle: {
									text: ''
								},
								xAxis: {
									type: 'category',
									labels: {
										rotation: -45,
										style: {
											fontSize: '13px',
											fontFamily: 'Verdana, sans-serif'
										}
									}
								},
								yAxis: {
									min: 0,
									title: {
										text: ''
									}
								},
								legend: {
									enabled: false
								},
								tooltip: {
									pointFormat: '<b>{point.y:.1f} POINTS</b>'
								},
								series: [{
									name: 'Companies',
									data: [],
									dataLabels: {
										enabled: true,
										rotation: -90,
										color: '#FFFFFF',
										align: 'right',
										format: '{point.y:.1f}', // one decimal
										y: 10, // 10 pixels down from the top
										style: {
											fontSize: '13px',
											fontFamily: 'Verdana, sans-serif'
										}
									}
								}]
							};
							
							var options3={
								chart: {
									renderTo: 'container3',
									plotBackgroundColor: null,
									plotBorderWidth: null,
									plotShadow: false,
									type: 'pie'
								},
								title: {
									text: ''
								},
								tooltip: {
									pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
								},
								plotOptions: {
									pie: {
										allowPointSelect: true,
										cursor: 'pointer',
										dataLabels: {
											enabled: true,
											format: '<b>{point.name}</b>: {point.percentage:.1f} %',
											style: {
												color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
											}
										}
									}
								},
								series: [{
									name: 'Ratio',
									colorByPoint: true,
									data: []
								}]								
							};
							
							var options4={
								chart: {
									renderTo: 'container4',
						            type: 'line'
						        },
						        title: {
						            text: ''
						        },
						        subtitle: {
						            text: ''
						        },
						        xAxis: {
						            categories: []
						        },
						        yAxis: {
						            title: {
						                text: ''
						            }
						        },
						        plotOptions: {
						            line: {
						                dataLabels: {
						                    enabled: true
						                },
						                enableMouseTracking: false
						            }
						        },
						        series: [{
						            name: '',
						            data: []
						        }]
								
							};
							//获取cookie中的sellerId
							//setCookie("sellerid",5);
							var sellerId=getCookie("sellerid");
							var startTime=document.getElementById("datetimepicker1").value;		
							var endTime=document.getElementById("datetimepicker2").value;
							var tradeType;
							if(document.getElementById("tradeType0").checked==true){
								tradeType=document.getElementById("tradeType0").value;
							}else{
								tradeType=document.getElementById("tradeType1").value;
							}
									
									
							$.ajax({
								url:"intelligentAnalysis?sellerId="+sellerId+"&startTime="+startTime+"&endTime="+endTime+"&tradeType="+tradeType,
								type: 'POST',
								dataType: 'json',
								success: function(AllDiagramsData){
									if(AllDiagramsData.errno!="0"){
										alert("Something wrong! Please try again!");
									}else{
										options1.series[0].data=AllDiagramsData.topSameIndustry.seriesData;
										options1.yAxis.title.text=AllDiagramsData.topSameIndustry.yAxisTitleText;
										//alert(AllDiagramsData.topSameIndustry.yAxisTitleText);
										
										options2.series[0].data=AllDiagramsData.topDiffIndustry.seriesData;
										options2.yAxis.title.text=AllDiagramsData.topDiffIndustry.yAxisTitleText;
										
										options3.series[0].data=AllDiagramsData.industryRatio.seriesData;
										options3.title.text="Industry ratio of "+AllDiagramsData.industryRatio.titleText;
										
										options4.series[0].data=AllDiagramsData.timeSequence.seriesData;
										options4.xAxis.categories=AllDiagramsData.timeSequence.xAxisCategories;
										options4.title.text="Trend of "+AllDiagramsData.timeSequence.yAxisTitleText;
										options4.yAxis.title.text=AllDiagramsData.timeSequence.yAxisTitleText;
										options4.series[0].name=AllDiagramsData.timeSequence.yAxisTitleText;
										
										var chart1 = new Highcharts.Chart(options1);
										var chart2 = new Highcharts.Chart(options2);
										var chart3 = new Highcharts.Chart(options3);
										var chart4 = new Highcharts.Chart(options4);
									}
									
								},
								error:function(data){
									alert("Something wrong! Please try again!");
								}
							});
													
						});	
			</script>
		</div>
	</body> 
</html>